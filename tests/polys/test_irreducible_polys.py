"""
A pytest module to test generating irreducible polynomials and testing irreducibility.

Sage:
    PARAMS = [(2,1), (2,2), (2,3), (2,4), (2,5), (2,6), (2,7), (2,8), (3,1), (3,2), (3,3), (3,4), (3,5), (3,6), (5,1), (5,2), (5,3), (5,4)]
    for p, m in PARAMS:
        print(f"IRREDUCIBLE_POLYS_{p}_{m} = [")
        R = GF(p)["x"]
        for f in R.polynomials(m):
            if f.is_monic() and f.is_irreducible():
                print(f"    {f.coefficients(sparse=False)[::-1]},")
        print("]\n")
"""
import pytest

import galois

PARAMS = [(2,1), (2,2), (2,3), (2,4), (2,5), (2,6), (2,7), (2,8), (3,1), (3,2), (3,3), (3,4), (3,5), (3,6), (5,1), (5,2), (5,3), (5,4)]

# LUT items are poly coefficients in degree-descending order

IRREDUCIBLE_POLYS_2_1 = [
    [1, 0],
    [1, 1],
]

IRREDUCIBLE_POLYS_2_2 = [
    [1, 1, 1],
]

IRREDUCIBLE_POLYS_2_3 = [
    [1, 0, 1, 1],
    [1, 1, 0, 1],
]

IRREDUCIBLE_POLYS_2_4 = [
    [1, 0, 0, 1, 1],
    [1, 1, 0, 0, 1],
    [1, 1, 1, 1, 1],
]

IRREDUCIBLE_POLYS_2_5 = [
    [1, 0, 0, 1, 0, 1],
    [1, 0, 1, 0, 0, 1],
    [1, 0, 1, 1, 1, 1],
    [1, 1, 0, 1, 1, 1],
    [1, 1, 1, 0, 1, 1],
    [1, 1, 1, 1, 0, 1],
]

IRREDUCIBLE_POLYS_2_6 = [
    [1, 0, 0, 0, 0, 1, 1],
    [1, 0, 0, 1, 0, 0, 1],
    [1, 0, 1, 0, 1, 1, 1],
    [1, 0, 1, 1, 0, 1, 1],
    [1, 1, 0, 0, 0, 0, 1],
    [1, 1, 0, 0, 1, 1, 1],
    [1, 1, 0, 1, 1, 0, 1],
    [1, 1, 1, 0, 0, 1, 1],
    [1, 1, 1, 0, 1, 0, 1],
]

IRREDUCIBLE_POLYS_2_7 = [
    [1, 0, 0, 0, 0, 0, 1, 1],
    [1, 0, 0, 0, 1, 0, 0, 1],
    [1, 0, 0, 0, 1, 1, 1, 1],
    [1, 0, 0, 1, 0, 0, 0, 1],
    [1, 0, 0, 1, 1, 1, 0, 1],
    [1, 0, 1, 0, 0, 1, 1, 1],
    [1, 0, 1, 0, 1, 0, 1, 1],
    [1, 0, 1, 1, 1, 0, 0, 1],
    [1, 0, 1, 1, 1, 1, 1, 1],
    [1, 1, 0, 0, 0, 0, 0, 1],
    [1, 1, 0, 0, 1, 0, 1, 1],
    [1, 1, 0, 1, 0, 0, 1, 1],
    [1, 1, 0, 1, 0, 1, 0, 1],
    [1, 1, 1, 0, 0, 1, 0, 1],
    [1, 1, 1, 0, 1, 1, 1, 1],
    [1, 1, 1, 1, 0, 0, 0, 1],
    [1, 1, 1, 1, 0, 1, 1, 1],
    [1, 1, 1, 1, 1, 1, 0, 1],
]

IRREDUCIBLE_POLYS_2_8 = [
    [1, 0, 0, 0, 1, 1, 0, 1, 1],
    [1, 0, 0, 0, 1, 1, 1, 0, 1],
    [1, 0, 0, 1, 0, 1, 0, 1, 1],
    [1, 0, 0, 1, 0, 1, 1, 0, 1],
    [1, 0, 0, 1, 1, 1, 0, 0, 1],
    [1, 0, 0, 1, 1, 1, 1, 1, 1],
    [1, 0, 1, 0, 0, 1, 1, 0, 1],
    [1, 0, 1, 0, 1, 1, 1, 1, 1],
    [1, 0, 1, 1, 0, 0, 0, 1, 1],
    [1, 0, 1, 1, 0, 0, 1, 0, 1],
    [1, 0, 1, 1, 0, 1, 0, 0, 1],
    [1, 0, 1, 1, 1, 0, 0, 0, 1],
    [1, 0, 1, 1, 1, 0, 1, 1, 1],
    [1, 0, 1, 1, 1, 1, 0, 1, 1],
    [1, 1, 0, 0, 0, 0, 1, 1, 1],
    [1, 1, 0, 0, 0, 1, 0, 1, 1],
    [1, 1, 0, 0, 0, 1, 1, 0, 1],
    [1, 1, 0, 0, 1, 1, 1, 1, 1],
    [1, 1, 0, 1, 0, 0, 0, 1, 1],
    [1, 1, 0, 1, 0, 1, 0, 0, 1],
    [1, 1, 0, 1, 1, 0, 0, 0, 1],
    [1, 1, 0, 1, 1, 1, 1, 0, 1],
    [1, 1, 1, 0, 0, 0, 0, 1, 1],
    [1, 1, 1, 0, 0, 1, 1, 1, 1],
    [1, 1, 1, 0, 1, 0, 1, 1, 1],
    [1, 1, 1, 0, 1, 1, 1, 0, 1],
    [1, 1, 1, 1, 0, 0, 1, 1, 1],
    [1, 1, 1, 1, 1, 0, 0, 1, 1],
    [1, 1, 1, 1, 1, 0, 1, 0, 1],
    [1, 1, 1, 1, 1, 1, 0, 0, 1],
]

IRREDUCIBLE_POLYS_3_1 = [
    [1, 0],
    [1, 1],
    [1, 2],
]

IRREDUCIBLE_POLYS_3_2 = [
    [1, 0, 1],
    [1, 1, 2],
    [1, 2, 2],
]

IRREDUCIBLE_POLYS_3_3 = [
    [1, 0, 2, 1],
    [1, 0, 2, 2],
    [1, 1, 0, 2],
    [1, 1, 1, 2],
    [1, 1, 2, 1],
    [1, 2, 0, 1],
    [1, 2, 1, 1],
    [1, 2, 2, 2],
]

IRREDUCIBLE_POLYS_3_4 = [
    [1, 0, 0, 1, 2],
    [1, 0, 0, 2, 2],
    [1, 0, 1, 0, 2],
    [1, 0, 1, 1, 1],
    [1, 0, 1, 2, 1],
    [1, 0, 2, 0, 2],
    [1, 1, 0, 0, 2],
    [1, 1, 0, 2, 1],
    [1, 1, 1, 0, 1],
    [1, 1, 1, 1, 1],
    [1, 1, 1, 2, 2],
    [1, 1, 2, 2, 2],
    [1, 2, 0, 0, 2],
    [1, 2, 0, 1, 1],
    [1, 2, 1, 0, 1],
    [1, 2, 1, 1, 2],
    [1, 2, 1, 2, 1],
    [1, 2, 2, 1, 2],
]

IRREDUCIBLE_POLYS_3_5 = [
    [1, 0, 0, 0, 2, 1],
    [1, 0, 0, 0, 2, 2],
    [1, 0, 0, 1, 1, 2],
    [1, 0, 0, 2, 1, 1],
    [1, 0, 1, 0, 1, 1],
    [1, 0, 1, 0, 1, 2],
    [1, 0, 1, 1, 0, 2],
    [1, 0, 1, 1, 2, 2],
    [1, 0, 1, 2, 0, 1],
    [1, 0, 1, 2, 2, 1],
    [1, 0, 2, 1, 0, 1],
    [1, 0, 2, 1, 1, 2],
    [1, 0, 2, 1, 2, 2],
    [1, 0, 2, 2, 0, 2],
    [1, 0, 2, 2, 1, 1],
    [1, 0, 2, 2, 2, 1],
    [1, 1, 0, 0, 0, 2],
    [1, 1, 0, 0, 1, 2],
    [1, 1, 0, 0, 2, 1],
    [1, 1, 0, 1, 0, 1],
    [1, 1, 0, 1, 1, 1],
    [1, 1, 0, 1, 2, 2],
    [1, 1, 1, 0, 1, 1],
    [1, 1, 1, 1, 2, 1],
    [1, 1, 1, 2, 1, 1],
    [1, 1, 1, 2, 1, 2],
    [1, 1, 2, 0, 0, 1],
    [1, 1, 2, 0, 2, 2],
    [1, 1, 2, 1, 0, 2],
    [1, 1, 2, 1, 1, 1],
    [1, 1, 2, 2, 0, 1],
    [1, 1, 2, 2, 0, 2],
    [1, 2, 0, 0, 0, 1],
    [1, 2, 0, 0, 1, 1],
    [1, 2, 0, 0, 2, 2],
    [1, 2, 0, 2, 0, 2],
    [1, 2, 0, 2, 1, 2],
    [1, 2, 0, 2, 2, 1],
    [1, 2, 1, 0, 1, 2],
    [1, 2, 1, 1, 1, 1],
    [1, 2, 1, 1, 1, 2],
    [1, 2, 1, 2, 2, 2],
    [1, 2, 2, 0, 0, 2],
    [1, 2, 2, 0, 2, 1],
    [1, 2, 2, 1, 0, 1],
    [1, 2, 2, 1, 0, 2],
    [1, 2, 2, 2, 0, 1],
    [1, 2, 2, 2, 1, 2],
]

IRREDUCIBLE_POLYS_3_6 = [
    [1, 0, 0, 0, 0, 1, 2],
    [1, 0, 0, 0, 0, 2, 2],
    [1, 0, 0, 0, 1, 1, 1],
    [1, 0, 0, 0, 1, 2, 1],
    [1, 0, 0, 0, 2, 0, 1],
    [1, 0, 0, 1, 0, 1, 2],
    [1, 0, 0, 1, 0, 2, 1],
    [1, 0, 0, 1, 1, 0, 1],
    [1, 0, 0, 1, 1, 2, 2],
    [1, 0, 0, 1, 2, 2, 1],
    [1, 0, 0, 2, 0, 1, 1],
    [1, 0, 0, 2, 0, 2, 2],
    [1, 0, 0, 2, 1, 0, 1],
    [1, 0, 0, 2, 1, 1, 2],
    [1, 0, 0, 2, 2, 1, 1],
    [1, 0, 1, 0, 2, 0, 1],
    [1, 0, 1, 0, 2, 1, 2],
    [1, 0, 1, 0, 2, 2, 2],
    [1, 0, 1, 1, 0, 0, 1],
    [1, 0, 1, 1, 0, 1, 1],
    [1, 0, 1, 1, 0, 2, 2],
    [1, 0, 1, 1, 1, 2, 2],
    [1, 0, 1, 2, 0, 0, 1],
    [1, 0, 1, 2, 0, 1, 2],
    [1, 0, 1, 2, 0, 2, 1],
    [1, 0, 1, 2, 1, 1, 2],
    [1, 0, 2, 0, 0, 0, 1],
    [1, 0, 2, 0, 1, 0, 1],
    [1, 0, 2, 0, 1, 1, 2],
    [1, 0, 2, 0, 1, 2, 2],
    [1, 0, 2, 1, 0, 2, 1],
    [1, 0, 2, 1, 1, 0, 2],
    [1, 0, 2, 1, 1, 1, 2],
    [1, 0, 2, 1, 1, 2, 1],
    [1, 0, 2, 2, 0, 1, 1],
    [1, 0, 2, 2, 1, 0, 2],
    [1, 0, 2, 2, 1, 1, 1],
    [1, 0, 2, 2, 1, 2, 2],
    [1, 1, 0, 0, 0, 0, 2],
    [1, 1, 0, 0, 0, 1, 2],
    [1, 1, 0, 0, 1, 1, 1],
    [1, 1, 0, 1, 0, 0, 2],
    [1, 1, 0, 1, 0, 1, 1],
    [1, 1, 0, 1, 1, 0, 1],
    [1, 1, 0, 1, 1, 1, 2],
    [1, 1, 0, 1, 2, 1, 2],
    [1, 1, 0, 2, 0, 0, 1],
    [1, 1, 0, 2, 1, 1, 1],
    [1, 1, 0, 2, 1, 2, 1],
    [1, 1, 0, 2, 2, 0, 1],
    [1, 1, 0, 2, 2, 0, 2],
    [1, 1, 1, 0, 0, 0, 1],
    [1, 1, 1, 0, 0, 1, 1],
    [1, 1, 1, 0, 1, 2, 2],
    [1, 1, 1, 0, 2, 0, 2],
    [1, 1, 1, 0, 2, 2, 1],
    [1, 1, 1, 1, 0, 1, 2],
    [1, 1, 1, 1, 0, 2, 1],
    [1, 1, 1, 1, 1, 1, 1],
    [1, 1, 1, 1, 1, 1, 2],
    [1, 1, 1, 1, 2, 2, 2],
    [1, 1, 1, 2, 0, 1, 1],
    [1, 1, 1, 2, 2, 0, 1],
    [1, 1, 1, 2, 2, 2, 2],
    [1, 1, 2, 0, 1, 0, 2],
    [1, 1, 2, 0, 1, 2, 1],
    [1, 1, 2, 0, 2, 2, 2],
    [1, 1, 2, 1, 0, 1, 2],
    [1, 1, 2, 1, 1, 0, 2],
    [1, 1, 2, 1, 1, 2, 2],
    [1, 1, 2, 1, 2, 1, 2],
    [1, 1, 2, 1, 2, 2, 1],
    [1, 1, 2, 2, 0, 0, 1],
    [1, 1, 2, 2, 0, 0, 2],
    [1, 1, 2, 2, 1, 2, 2],
    [1, 1, 2, 2, 2, 0, 2],
    [1, 1, 2, 2, 2, 2, 1],
    [1, 2, 0, 0, 0, 0, 2],
    [1, 2, 0, 0, 0, 2, 2],
    [1, 2, 0, 0, 1, 2, 1],
    [1, 2, 0, 1, 0, 0, 1],
    [1, 2, 0, 1, 1, 1, 1],
    [1, 2, 0, 1, 1, 2, 1],
    [1, 2, 0, 1, 2, 0, 1],
    [1, 2, 0, 1, 2, 0, 2],
    [1, 2, 0, 2, 0, 0, 2],
    [1, 2, 0, 2, 0, 2, 1],
    [1, 2, 0, 2, 1, 0, 1],
    [1, 2, 0, 2, 1, 2, 2],
    [1, 2, 0, 2, 2, 2, 2],
    [1, 2, 1, 0, 0, 0, 1],
    [1, 2, 1, 0, 0, 2, 1],
    [1, 2, 1, 0, 1, 1, 2],
    [1, 2, 1, 0, 2, 0, 2],
    [1, 2, 1, 0, 2, 1, 1],
    [1, 2, 1, 1, 0, 2, 1],
    [1, 2, 1, 1, 2, 0, 1],
    [1, 2, 1, 1, 2, 1, 2],
    [1, 2, 1, 2, 0, 1, 1],
    [1, 2, 1, 2, 0, 2, 2],
    [1, 2, 1, 2, 1, 2, 1],
    [1, 2, 1, 2, 1, 2, 2],
    [1, 2, 1, 2, 2, 1, 2],
    [1, 2, 2, 0, 1, 0, 2],
    [1, 2, 2, 0, 1, 1, 1],
    [1, 2, 2, 0, 2, 1, 2],
    [1, 2, 2, 1, 0, 0, 1],
    [1, 2, 2, 1, 0, 0, 2],
    [1, 2, 2, 1, 1, 1, 2],
    [1, 2, 2, 1, 2, 0, 2],
    [1, 2, 2, 1, 2, 1, 1],
    [1, 2, 2, 2, 0, 2, 2],
    [1, 2, 2, 2, 1, 0, 2],
    [1, 2, 2, 2, 1, 1, 2],
    [1, 2, 2, 2, 2, 1, 1],
    [1, 2, 2, 2, 2, 2, 2],
]

IRREDUCIBLE_POLYS_5_1 = [
    [1, 0],
    [1, 1],
    [1, 2],
    [1, 3],
    [1, 4],
]

IRREDUCIBLE_POLYS_5_2 = [
    [1, 0, 2],
    [1, 0, 3],
    [1, 1, 1],
    [1, 1, 2],
    [1, 2, 3],
    [1, 2, 4],
    [1, 3, 3],
    [1, 3, 4],
    [1, 4, 1],
    [1, 4, 2],
]

IRREDUCIBLE_POLYS_5_3 = [
    [1, 0, 1, 1],
    [1, 0, 1, 4],
    [1, 0, 2, 1],
    [1, 0, 2, 4],
    [1, 0, 3, 2],
    [1, 0, 3, 3],
    [1, 0, 4, 2],
    [1, 0, 4, 3],
    [1, 1, 0, 1],
    [1, 1, 0, 2],
    [1, 1, 1, 3],
    [1, 1, 1, 4],
    [1, 1, 3, 1],
    [1, 1, 3, 4],
    [1, 1, 4, 1],
    [1, 1, 4, 3],
    [1, 2, 0, 1],
    [1, 2, 0, 3],
    [1, 2, 1, 3],
    [1, 2, 1, 4],
    [1, 2, 2, 2],
    [1, 2, 2, 3],
    [1, 2, 4, 2],
    [1, 2, 4, 4],
    [1, 3, 0, 2],
    [1, 3, 0, 4],
    [1, 3, 1, 1],
    [1, 3, 1, 2],
    [1, 3, 2, 2],
    [1, 3, 2, 3],
    [1, 3, 4, 1],
    [1, 3, 4, 3],
    [1, 4, 0, 3],
    [1, 4, 0, 4],
    [1, 4, 1, 1],
    [1, 4, 1, 2],
    [1, 4, 3, 1],
    [1, 4, 3, 4],
    [1, 4, 4, 2],
    [1, 4, 4, 4],
]

IRREDUCIBLE_POLYS_5_4 = [
    [1, 0, 0, 0, 2],
    [1, 0, 0, 0, 3],
    [1, 0, 0, 1, 4],
    [1, 0, 0, 2, 4],
    [1, 0, 0, 3, 4],
    [1, 0, 0, 4, 4],
    [1, 0, 1, 0, 2],
    [1, 0, 1, 1, 1],
    [1, 0, 1, 2, 2],
    [1, 0, 1, 2, 3],
    [1, 0, 1, 3, 2],
    [1, 0, 1, 3, 3],
    [1, 0, 1, 4, 1],
    [1, 0, 2, 0, 3],
    [1, 0, 2, 2, 1],
    [1, 0, 2, 2, 3],
    [1, 0, 2, 3, 1],
    [1, 0, 2, 3, 3],
    [1, 0, 3, 0, 3],
    [1, 0, 3, 1, 1],
    [1, 0, 3, 1, 3],
    [1, 0, 3, 4, 1],
    [1, 0, 3, 4, 3],
    [1, 0, 4, 0, 2],
    [1, 0, 4, 1, 2],
    [1, 0, 4, 1, 3],
    [1, 0, 4, 2, 1],
    [1, 0, 4, 3, 1],
    [1, 0, 4, 4, 2],
    [1, 0, 4, 4, 3],
    [1, 1, 0, 0, 4],
    [1, 1, 0, 1, 3],
    [1, 1, 0, 2, 3],
    [1, 1, 0, 2, 4],
    [1, 1, 0, 3, 2],
    [1, 1, 0, 4, 1],
    [1, 1, 0, 4, 2],
    [1, 1, 1, 0, 1],
    [1, 1, 1, 1, 3],
    [1, 1, 1, 1, 4],
    [1, 1, 1, 2, 4],
    [1, 1, 1, 3, 3],
    [1, 1, 1, 4, 2],
    [1, 1, 2, 0, 2],
    [1, 1, 2, 1, 2],
    [1, 1, 2, 1, 3],
    [1, 1, 2, 2, 1],
    [1, 1, 2, 2, 2],
    [1, 1, 2, 3, 4],
    [1, 1, 2, 4, 4],
    [1, 1, 3, 0, 1],
    [1, 1, 3, 0, 3],
    [1, 1, 3, 2, 1],
    [1, 1, 3, 4, 2],
    [1, 1, 3, 4, 4],
    [1, 1, 4, 0, 2],
    [1, 1, 4, 1, 1],
    [1, 1, 4, 1, 4],
    [1, 1, 4, 4, 1],
    [1, 1, 4, 4, 3],
    [1, 2, 0, 0, 4],
    [1, 2, 0, 1, 3],
    [1, 2, 0, 1, 4],
    [1, 2, 0, 2, 1],
    [1, 2, 0, 2, 2],
    [1, 2, 0, 3, 3],
    [1, 2, 0, 4, 2],
    [1, 2, 1, 0, 2],
    [1, 2, 1, 2, 1],
    [1, 2, 1, 2, 3],
    [1, 2, 1, 3, 1],
    [1, 2, 1, 3, 4],
    [1, 2, 2, 0, 1],
    [1, 2, 2, 0, 3],
    [1, 2, 2, 1, 1],
    [1, 2, 2, 2, 2],
    [1, 2, 2, 2, 4],
    [1, 2, 3, 0, 2],
    [1, 2, 3, 1, 1],
    [1, 2, 3, 1, 2],
    [1, 2, 3, 2, 4],
    [1, 2, 3, 3, 2],
    [1, 2, 3, 3, 3],
    [1, 2, 3, 4, 4],
    [1, 2, 4, 0, 1],
    [1, 2, 4, 1, 4],
    [1, 2, 4, 2, 2],
    [1, 2, 4, 3, 3],
    [1, 2, 4, 3, 4],
    [1, 2, 4, 4, 3],
    [1, 3, 0, 0, 4],
    [1, 3, 0, 1, 2],
    [1, 3, 0, 2, 3],
    [1, 3, 0, 3, 1],
    [1, 3, 0, 3, 2],
    [1, 3, 0, 4, 3],
    [1, 3, 0, 4, 4],
    [1, 3, 1, 0, 2],
    [1, 3, 1, 2, 1],
    [1, 3, 1, 2, 4],
    [1, 3, 1, 3, 1],
    [1, 3, 1, 3, 3],
    [1, 3, 2, 0, 1],
    [1, 3, 2, 0, 3],
    [1, 3, 2, 3, 2],
    [1, 3, 2, 3, 4],
    [1, 3, 2, 4, 1],
    [1, 3, 3, 0, 2],
    [1, 3, 3, 1, 4],
    [1, 3, 3, 2, 2],
    [1, 3, 3, 2, 3],
    [1, 3, 3, 3, 4],
    [1, 3, 3, 4, 1],
    [1, 3, 3, 4, 2],
    [1, 3, 4, 0, 1],
    [1, 3, 4, 1, 3],
    [1, 3, 4, 2, 3],
    [1, 3, 4, 2, 4],
    [1, 3, 4, 3, 2],
    [1, 3, 4, 4, 4],
    [1, 4, 0, 0, 4],
    [1, 4, 0, 1, 1],
    [1, 4, 0, 1, 2],
    [1, 4, 0, 2, 2],
    [1, 4, 0, 3, 3],
    [1, 4, 0, 3, 4],
    [1, 4, 0, 4, 3],
    [1, 4, 1, 0, 1],
    [1, 4, 1, 1, 2],
    [1, 4, 1, 2, 3],
    [1, 4, 1, 3, 4],
    [1, 4, 1, 4, 3],
    [1, 4, 1, 4, 4],
    [1, 4, 2, 0, 2],
    [1, 4, 2, 1, 4],
    [1, 4, 2, 2, 4],
    [1, 4, 2, 3, 1],
    [1, 4, 2, 3, 2],
    [1, 4, 2, 4, 2],
    [1, 4, 2, 4, 3],
    [1, 4, 3, 0, 1],
    [1, 4, 3, 0, 3],
    [1, 4, 3, 1, 2],
    [1, 4, 3, 1, 4],
    [1, 4, 3, 3, 1],
    [1, 4, 4, 0, 2],
    [1, 4, 4, 1, 1],
    [1, 4, 4, 1, 3],
    [1, 4, 4, 4, 1],
    [1, 4, 4, 4, 4],
]


def test_irreducible_poly_exceptions():
    with pytest.raises(TypeError):
        galois.irreducible_poly(2.0, 3)
    with pytest.raises(TypeError):
        galois.irreducible_poly(2, 3.0)
    with pytest.raises(ValueError):
        galois.irreducible_poly(4, 3)
    with pytest.raises(ValueError):
        galois.irreducible_poly(2, 0)
    with pytest.raises(ValueError):
        galois.irreducible_poly(2, 3, method="invalid-argument")


@pytest.mark.parametrize("characteristic,degree", PARAMS)
def test_irreducible_poly_min(characteristic, degree):
    LUT = eval(f"IRREDUCIBLE_POLYS_{characteristic}_{degree}")
    assert galois.irreducible_poly(characteristic, degree).coeffs.tolist() == LUT[0]


@pytest.mark.parametrize("characteristic,degree", PARAMS)
def test_irreducible_poly_max(characteristic, degree):
    LUT = eval(f"IRREDUCIBLE_POLYS_{characteristic}_{degree}")
    assert galois.irreducible_poly(characteristic, degree, method="max").coeffs.tolist() == LUT[-1]


@pytest.mark.parametrize("characteristic,degree", PARAMS)
def test_irreducible_poly_random(characteristic, degree):
    LUT = eval(f"IRREDUCIBLE_POLYS_{characteristic}_{degree}")
    assert galois.irreducible_poly(characteristic, degree, method="random").coeffs.tolist() in LUT


def test_irreducible_polys_exceptions():
    with pytest.raises(TypeError):
        galois.irreducible_polys(2.0, 3)
    with pytest.raises(TypeError):
        galois.irreducible_polys(2, 3.0)
    with pytest.raises(ValueError):
        galois.irreducible_polys(4, 3)
    with pytest.raises(ValueError):
        galois.irreducible_polys(2, 0)


@pytest.mark.parametrize("characteristic,degree", PARAMS)
def test_irreducible_polys(characteristic, degree):
    LUT = eval(f"IRREDUCIBLE_POLYS_{characteristic}_{degree}")
    assert [f.coeffs.tolist() for f in galois.irreducible_polys(characteristic, degree)] == LUT


def test_is_irreducible_exceptions():
    with pytest.raises(TypeError):
        galois.is_irreducible([1, 0, 1, 1])
    with pytest.raises(ValueError):
        galois.is_irreducible(galois.Poly([1]))
    with pytest.raises(ValueError):
        galois.is_irreducible(galois.Poly([1], field=galois.GF(2**2)))


@pytest.mark.parametrize("characteristic,degree", PARAMS)
def test_is_irreducible(characteristic, degree):
    GF = galois.GF(characteristic)
    LUT = eval(f"IRREDUCIBLE_POLYS_{characteristic}_{degree}")
    assert all(galois.is_irreducible(galois.Poly(f, field=GF)) for f in LUT)


@pytest.mark.parametrize("characteristic,degree", PARAMS)
def test_is_not_irreducible(characteristic, degree):
    if degree == 1:
        # Every degree-1 polynomial is irreducible
        return

    LUT = eval(f"IRREDUCIBLE_POLYS_{characteristic}_{degree}")
    while True:
        f = galois.Poly.Random(degree, field=galois.GF(characteristic))
        f /= f.coeffs[0]  # Make monic
        if f.coeffs.tolist() not in LUT:
            break
    assert not galois.is_irreducible(f)
